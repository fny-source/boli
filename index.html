<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>æ€¨ç§å¥³é…æ€æ¡Œå½• Â· ç»ˆæç‰ˆ Day1â€“Day20</title>
<style>
:root{
  --bg:#0f1220;
  --card:#1b1f3a;
  --card2:#14182e;
  --text:#eaeaff;
  --muted:#b7b9ff;
  --border:#3b3f7a;
  --accent:#ff6aa2;
  --good:#7cffb2;
  --warn:#ffd36b;
  --bad:#ff5b5b;
  --glow:#ff6aa288;
  --shadow:0 0 12px #0007;
  --r:14px;
}
*{box-sizing:border-box}
body{
  margin:0;
  color:var(--text);
  font-family:"PingFang SC","Microsoft YaHei",system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background: radial-gradient(1200px 800px at 20% 0%, #1a1f44 0%, var(--bg) 55%, #0b0d18 100%);
}
.container{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:12px;
  padding:12px;
}
.card{
  background:linear-gradient(180deg,var(--card) 0%,var(--card2) 100%);
  border:1px solid var(--border);
  border-radius:var(--r);
  padding:14px;
  box-shadow:var(--shadow);
  position:relative;
  overflow:hidden;
}
h3{margin:0 0 10px; color:var(--accent); font-size:16px; letter-spacing:.4px;}
.small{font-size:12px;color:var(--muted);line-height:1.55}
.hr{height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent);margin:10px 0;}
@media(max-width:820px){.container{grid-template-columns:1fr;}}

/* story */
#story{height:300px;overflow:auto;line-height:1.78;font-size:14px;padding-right:6px;white-space:pre-wrap;}
#story::-webkit-scrollbar{width:8px}
#story::-webkit-scrollbar-thumb{background:var(--border);border-radius:10px}

/* options */
.option{
  background:#242a62;
  border:1px solid #2f3578;
  padding:10px;
  margin:8px 0;
  border-radius:12px;
  cursor:pointer;
  transition:.15s;
  user-select:none;
}
.option:hover{transform:translateY(-1px); border-color:var(--accent); box-shadow:0 0 10px var(--glow);}
.option.highlight{border-color:var(--accent); box-shadow:0 0 16px var(--glow);}
.option.disabled{opacity:.55;cursor:not-allowed;transform:none;box-shadow:none}
.tag{
  display:inline-block;
  font-size:12px;
  padding:2px 8px;
  border-radius:999px;
  margin-right:8px;
  border:1px solid #ffffff22;
  opacity:.95;
}
.tag-main{color:var(--accent);background:#ff6aa214;border-color:#ff6aa244;}
.tag-safe{color:var(--good);background:#7cffb214;border-color:#7cffb255;}
.tag-risk{color:var(--bad);background:#ff5b5b14;border-color:#ff5b5b66;}
.tag-warn{color:var(--warn);background:#ffd36b14;border-color:#ffd36b66;}

/* stats */
.stat{display:flex;align-items:center;gap:10px;margin:6px 0;font-size:13px;}
.stat b{width:92px;color:#fff;font-weight:600}
.bar{flex:1;height:8px;background:#00000033;border:1px solid #ffffff12;border-radius:999px;overflow:hidden}
.fill{height:100%;background:linear-gradient(90deg,#7cffb2,#ffd36b,#ff6aa2);width:50%}
.val{width:44px;text-align:right}

/* system */
.sysRow{display:flex;justify-content:space-between;align-items:center;gap:10px;margin:6px 0;font-size:13px;}
.badge{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid #ffffff22;}
.badge-ok{color:var(--good);border-color:#7cffb266;background:#7cffb214;}
.badge-warn{color:var(--warn);border-color:#ffd36b66;background:#ffd36b12;}
.badge-bad{color:var(--bad);border-color:#ff5b5b66;background:#ff5b5b14;}

.btn{
  cursor:pointer;
  border-radius:12px;
  padding:9px 12px;
  border:1px solid #ffffff22;
  background:#20245a;
  color:var(--text);
  transition:.15s;
  font-size:13px;
}
.btn:hover{transform:translateY(-1px);border-color:var(--accent);box-shadow:0 0 10px var(--glow);}
.btn:disabled{opacity:.55;cursor:not-allowed;transform:none;box-shadow:none}

.float{
  position:fixed; right:14px; top:14px; z-index:9999;
  padding:8px 10px; border-radius:10px;
  border:1px solid #ffffff22; background:#12152aee; box-shadow:var(--shadow);
  animation: floatUp 1.4s ease-out forwards; font-size:13px;
}
.float.good{color:var(--good);border-color:#7cffb255}
.float.bad{color:var(--bad);border-color:#ff5b5b66}
.float.warn{color:var(--warn);border-color:#ffd36b66}
@keyframes floatUp{from{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-40px)}}

.flash{position:fixed;inset:0;background:radial-gradient(900px 400px at 50% 20%, #ff5b5b33, transparent 70%);opacity:0;pointer-events:none;z-index:9998;}
.flash.on{animation:flash .55s ease-in-out;}
@keyframes flash{0%{opacity:0}35%{opacity:1}100%{opacity:0}}
.shake{animation:shake .42s linear}
@keyframes shake{0%{transform:translateX(0)}20%{transform:translateX(-6px)}40%{transform:translateX(6px)}60%{transform:translateX(-4px)}80%{transform:translateX(4px)}100%{transform:translateX(0)}}

/* modals */
.mask{position:fixed;inset:0;background:#00000088;display:none;align-items:center;justify-content:center;z-index:10000;}
.mask.show{display:flex}
.modal{
  width:min(860px, 94vw);
  max-height:86vh;
  overflow:auto;
  background:linear-gradient(180deg,#1b1f3a 0%, #14182e 100%);
  border:1px solid var(--border);
  border-radius:var(--r);
  box-shadow:var(--shadow);
  padding:14px;
}
.modalTop{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.grid2{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px;}
@media(max-width:680px){.grid2{grid-template-columns:1fr}}
.item{border:1px solid #ffffff1a;background:#10132a66;border-radius:12px;padding:10px;}
.item h4{margin:0 0 6px;color:#fff;font-size:14px;}
.meta{display:flex;gap:8px;align-items:center;margin:6px 0;font-size:12px;color:var(--muted);flex-wrap:wrap}
.price{color:var(--accent);border:1px solid #ff6aa244;background:#ff6aa214;border-radius:999px;padding:2px 8px;}
.desc{font-size:12px;line-height:1.55;color:#d7d9ff;}
.row{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-top:10px;flex-wrap:wrap}

/* portrait */
.portraitWrap{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.portrait{
  width:54px;height:54px;border-radius:14px;
  border:1px solid #ffffff22; background:#0c0f22;
  display:flex;align-items:center;justify-content:center;
  overflow:hidden;
}
.portrait svg{width:100%;height:100%}
.pName{font-weight:800;color:#fff}
.pRole{font-size:12px;color:var(--muted)}
.chip{font-size:12px;border:1px solid #ffffff22;border-radius:999px;padding:3px 8px;background:#00000022}
</style>
</head>

<body>
<div class="flash" id="flash"></div>

<div class="container">
  <div class="card" id="cardStory">
    <h3>ğŸ“œ å½“å‰å‰§æƒ…</h3>
    <div class="portraitWrap">
      <div class="portrait" id="portraitBox"></div>
      <div>
        <div class="pName" id="pName"></div>
        <div class="pRole" id="pRole"></div>
      </div>
      <button class="btn" id="btnPortrait">åˆ‡æ¢ç«‹ç»˜</button>
      <span class="chip" id="dayChip">Day 1</span>
    </div>
    <div class="hr"></div>
    <div class="small" id="subtitle"></div>
    <div class="hr"></div>
    <div id="story"></div>
  </div>

  <div class="card" id="cardAction">
    <h3>ğŸ¯ è¡ŒåŠ¨é¢æ¿</h3>
    <div class="small">æ¯å›åˆï¼šå…ˆç‚¹ 1 ä¸ªè¡ŒåŠ¨ï¼ˆè¿›å…¥â€œç»“ç®—â€ï¼‰â†’ å†ç‚¹ã€ç»“æŸæœ¬å›åˆã€‘è¿›å…¥ä¸‹ä¸€å¤©ã€‚é«˜äº®=æ€æ¡Œ/é«˜é£é™©ã€‚</div>
    <div class="hr"></div>
    <div id="options"></div>
    <div class="hr"></div>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <button class="btn" id="btnCustom">âœï¸ è‡ªå®šä¹‰è¡ŒåŠ¨</button>
      <button class="btn" id="btnAI">ğŸ¤– AIç»­å†™</button>
      <button class="btn" id="btnEnd">â© ç»“æŸæœ¬å›åˆ</button>
      <button class="btn" id="btnSkip">â© ç›´æ¥åˆ°Day20ç»“å±€</button>
    </div>
  </div>

  <div class="card" id="cardStats">
    <h3>ğŸ“Š è§’è‰²çŠ¶æ€</h3>
    <div class="small">ç³»ç»Ÿè­¦å‘Šå€¼â‰¥70ä¼šæ›´ç‹ ï¼›å¥åº·â‰¤15å¯èƒ½â€œç—…å€’â€å¼ºåˆ¶ä¼‘å…»ã€‚Day20 è‡ªåŠ¨ç»“å±€åˆ¤å®šã€‚</div>
    <div class="hr"></div>
    <div id="stats"></div>
  </div>

  <div class="card" id="cardSystem">
    <h3>âš™ ç³»ç»Ÿç›‘æ§</h3>
    <div id="system"></div>
    <div class="hr"></div>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <button class="btn" id="btnShop">ğŸ›’ ç³»ç»Ÿå•†åŸ</button>
      <button class="btn" id="btnAch">ğŸ† æˆå°±</button>
      <button class="btn" id="btnSave">ğŸ’¾ å­˜æ¡£</button>
      <button class="btn" id="btnLoad">ğŸ“¥ è¯»æ¡£</button>
      <button class="btn" id="btnReset">ğŸ§¨ æ¸…æ¡£é‡å¼€</button>
    </div>
    <div class="hr"></div>
    <div class="small" id="debug"></div>
  </div>
</div>

<!-- Shop -->
<div class="mask" id="shopMask">
  <div class="modal">
    <div class="modalTop">
      <div>
        <div style="font-weight:900;color:#fff">ğŸ›’ ç³»ç»Ÿå•†åŸ</div>
        <div class="small">è´§å¸=æ€æ¡Œå€¼ã€‚ä¹°æŠ€èƒ½èƒ½æ›´â€œéª—è¿‡ç³»ç»Ÿâ€ã€‚</div>
      </div>
      <button class="btn" id="btnCloseShop">å…³é—­</button>
    </div>
    <div class="hr"></div>
    <div class="small" id="shopMoney"></div>
    <div class="grid2" id="shopGrid"></div>
  </div>
</div>

<!-- Achievements -->
<div class="mask" id="achMask">
  <div class="modal">
    <div class="modalTop">
      <div>
        <div style="font-weight:900;color:#fff">ğŸ† æˆå°±ç³»ç»Ÿ</div>
        <div class="small">è¾¾æˆæ¡ä»¶è‡ªåŠ¨è§£é”ï¼ˆå­˜æ¡£ä¼šä¿å­˜ï¼‰ã€‚</div>
      </div>
      <button class="btn" id="btnCloseAch">å…³é—­</button>
    </div>
    <div class="hr"></div>
    <div id="achList" class="grid2"></div>
  </div>
</div>

<!-- AI Settings -->
<div class="mask" id="aiMask">
  <div class="modal">
    <div class="modalTop">
      <div>
        <div style="font-weight:900;color:#fff">ğŸ¤– AIç»­å†™è®¾ç½®</div>
        <div class="small">è¯´æ˜ï¼šè¿™æ˜¯çº¯å‰ç«¯ç½‘é¡µï¼Œä¼šç›´æ¥ä»æµè§ˆå™¨è¯·æ±‚ä½ çš„æ¥å£ã€‚å¦‚æœä½ çš„æ¥å£ä¸å…è®¸ CORSï¼Œä¼šæŠ¥â€œè¯·æ±‚å¼‚å¸¸â€ã€‚</div>
      </div>
      <button class="btn" id="btnCloseAI">å…³é—­</button>
    </div>
    <div class="hr"></div>
    <div class="small">Base URLï¼ˆOpenAIå…¼å®¹ï¼‰ï¼š</div>
    <input id="aiBase" style="width:100%;padding:10px;border-radius:12px;border:1px solid #ffffff22;background:#0e1024;color:var(--text)" placeholder="ä¾‹å¦‚ https://api.gemai.cc/v1">
    <div style="height:10px"></div>
    <div class="small">Modelï¼š</div>
    <input id="aiModel" style="width:100%;padding:10px;border-radius:12px;border:1px solid #ffffff22;background:#0e1024;color:var(--text)" placeholder="ä¾‹å¦‚ gpt-4o-mini / gpt-4.1-mini / ä½ çš„ç«™ç‚¹æ¨¡å‹å">
    <div style="height:10px"></div>
    <div class="small">API Keyï¼ˆåªä¿å­˜åœ¨ä½ æœ¬æœº localStorageï¼Œä¸ä¼šä¸Šä¼ åˆ°GitHubï¼‰ï¼š</div>
    <input id="aiKey" type="password" style="width:100%;padding:10px;border-radius:12px;border:1px solid #ffffff22;background:#0e1024;color:var(--text)" placeholder="sk-...">
    <div style="height:10px"></div>
    <div class="row">
      <button class="btn" id="btnSaveAI">ä¿å­˜è®¾ç½®</button>
      <button class="btn" id="btnTestAI">æµ‹è¯•è¯·æ±‚</button>
      <span class="small" id="aiHint"></span>
    </div>
    <div class="hr"></div>
    <div class="small">AIç»­å†™ä¼šåŸºäºï¼šå½“å¤©å‰§æƒ… + ä½ åˆšé€‰çš„è¡ŒåŠ¨ + å½“å‰è·¯çº¿ï¼ˆç”œå® /æƒè°‹/æ€æ¡Œï¼‰ã€‚</div>
  </div>
</div>

<script>
/* =========================
  ç»ˆæç‰ˆå¼•æ“ï¼ˆä¿®å¤ç‰ˆï¼‰
  - ä¸ä¼šâ€œé»˜è®¤é€‰ç¬¬äºŒä¸ªâ€
  - é€‰é¡¹ä¼šéš Day å˜åŒ–
  - å…ˆé€‰è¡ŒåŠ¨ -> å†ç»“æŸå›åˆ -> è¿›ä¸‹ä¸€å¤©
  - ä¿®å¤ ReferenceErrorï¼ˆé¿å… TDZï¼‰
========================= */

/* ====== å·¥å…· ====== */
const $ = (id)=>document.getElementById(id);
const clamp = (n,min,max)=>Math.max(min,Math.min(max,n));
function tip(text, kind="good"){
  const d=document.createElement("div");
  d.className=`float ${kind}`;
  d.innerText=text;
  document.body.appendChild(d);
  setTimeout(()=>d.remove(),1400);
}
function safeJsonParse(s, fallback=null){
  try{ return JSON.parse(s); }catch(e){ return fallback; }
}
function nowISO(){ return new Date().toISOString(); }

/* ====== ç«‹ç»˜ï¼ˆå†…ç½®SVGå ä½ï¼Œä¸ä¾èµ–å¤–é“¾ï¼‰ ====== */
function svgPortrait(bg="#ff6aa2", fg="#0f1220", text="æŸ³"){
  return `
  <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0" stop-color="${bg}" stop-opacity="0.85"/>
        <stop offset="1" stop-color="#7cffb2" stop-opacity="0.25"/>
      </linearGradient>
    </defs>
    <rect x="0" y="0" width="100" height="100" rx="18" fill="url(#g)"/>
    <circle cx="50" cy="42" r="18" fill="${fg}" opacity="0.7"/>
    <rect x="28" y="62" width="44" height="26" rx="13" fill="${fg}" opacity="0.55"/>
    <text x="50" y="55" text-anchor="middle" font-size="26" fill="#ffffff" font-weight="900">${text}</text>
  </svg>`;
}
const Portraits = {
  LIU: {
    name:"æŸ³æ‰¶é£",
    role:"ã€Œæ€¨ç§å¥³é…ã€â†’ã€Œæ€æ¡Œç©å®¶ã€",
    icon: svgPortrait("#ff6aa2","#0f1220","æŸ³"),
    art:  svgPortrait("#ffd36b","#0f1220","æŸ³")
  },
  PRINCE: {
    name:"æ…•å®¹ç©",
    role:"å¤ªå­ Â· å†·é¢æƒæŸ„",
    icon: svgPortrait("#7cffb2","#0f1220","ç©"),
    art:  svgPortrait("#2bd0ff","#0f1220","ç©")
  },
  SU: {
    name:"è‹æ¸…è²",
    role:"ä¸ç›¸åºœ Â· ç™½è²å¸¦åˆº",
    icon: svgPortrait("#c7b0ff","#0f1220","è‹"),
    art:  svgPortrait("#ff7ad9","#0f1220","è‹")
  }
};
let portraitMode = "icon"; // icon/art

/* ====== å•†åŸ ====== */
const Shop = [
  {id:"shield", name:"å±è”½ç¬¦", price:10, desc:"ä¸‹ä¸€æ¬¡å…ç³»ç»Ÿæƒ©ç½šï¼ˆä¸€æ¬¡æ€§ï¼‰ã€‚", apply:s=>s.buffs.noPunishOnce=true},
  {id:"actor",  name:"æ¼”æŠ€å¤§å¸ˆ", price:40, desc:"è¢«åŠ¨ï¼šæƒ©ç½šè§¦å‘æ¦‚ç‡é™ä½ï¼ˆæ›´å®¹æ˜“éª—è¿‡ç³»ç»Ÿï¼‰ã€‚", apply:s=>s.buffs.actor=true},
  {id:"iron",   name:"é“è¡€å¿ƒé˜²", price:30, desc:"è¢«åŠ¨ï¼šæƒ©ç½šå¯¹å¿ƒæ™º/å¥åº·çš„ä¼¤å®³-1ã€‚", apply:s=>s.buffs.iron=true},
  {id:"intel",  name:"æƒ…æŠ¥çº¿äºº", price:25, desc:"ä¸€æ¬¡æ€§ï¼šä¸‹ä¸€å›åˆè°‹ç•¥+3ï¼ˆè‡ªåŠ¨è§¦å‘ï¼‰ã€‚", apply:s=>s.buffs.nextIntelBoost=true},
  {id:"lux",    name:"ç²ç‘äººè„‰", price:35, desc:"è¢«åŠ¨ï¼šç¤¾äº¤/ä½“é¢è·¯çº¿é¢å¤–+2å£°æœ›ã€‚", apply:s=>s.buffs.lux=true},
];

/* ====== æˆå°±ç³»ç»Ÿ ====== */
const Achievements = [
  {id:"firstBlood", name:"ç¬¬ä¸€æ»´æ€æ¡Œ", desc:"æ€æ¡Œå€¼â‰¥6", check:s=>s.player["æ€æ¡Œå€¼"]>=6},
  {id:"sweetStart", name:"ç”œå® å¼€ç«¯", desc:"å¤ªå­å¥½æ„Ÿâ‰¥10", check:s=>s.player["å¤ªå­å¥½æ„Ÿ"]>=10},
  {id:"powerShadow",name:"æƒè°‹å…¥éª¨", desc:"è°‹ç•¥â‰¥85 ä¸” è‹æ¸…è²æ€€ç–‘â‰¥12", check:s=>s.player["è°‹ç•¥"]>=85 && s.player["è‹æ¸…è²æ€€ç–‘"]>=12},
  {id:"systemHatesU",name:"ç³»ç»Ÿè®°ä»‡", desc:"ç³»ç»Ÿè­¦å‘Šå€¼â‰¥70", check:s=>s.player["ç³»ç»Ÿè­¦å‘Šå€¼"]>=70},
  {id:"survivor",   name:"è‹Ÿä½ä¹Ÿæ˜¯èµ¢", desc:"å¥åº·â‰¥80 ä¸” è¿‡åˆ°Day10", check:s=>s.day>=10 && s.player["å¥åº·"]>=80},
  {id:"allIn",      name:"æ€åˆ°å¤©äº®", desc:"æ€æ¡Œå€¼â‰¥30", check:s=>s.player["æ€æ¡Œå€¼"]>=30},
  {id:"day20",      name:"èµ°åˆ°ç»ˆå±€", desc:"åˆ°è¾¾Day20", check:s=>s.day>=20},
];

/* ====== çŠ¶æ€ ====== */
const DEFAULT_STATE = ()=>({
  day: 1,
  phase: "CHOOSE", // CHOOSE / RESOLVED / ENDED
  selected: null,
  route: { sweet:0, power:0, chaos:0 }, // ä¸‰æ¡è·¯çº¿è®¡åˆ†
  unlocked: {},
  player: {
    é£å: 92,
    è°‹ç•¥: 78,
    å¿ƒæ™º: 74,
    å¥åº·: 88,
    æ€æ¡Œå€¼: 0,
    åç¦»åº¦: 0,
    è´µå¥³å£°æœ›: 85,
    å®¶æ—å£°æœ›: 95,
    ç³»ç»Ÿè­¦å‘Šå€¼: 0,
    "å¤ªå­å¥½æ„Ÿ": 0,
    "è‹æ¸…è²æ€€ç–‘": 0,
  },
  buffs: {
    noPunishOnce:false,
    actor:false,
    iron:false,
    nextIntelBoost:false,
    lux:false,
  },
  flags: {
    mainDone:false,
    metPrince:false,
    gotEvidence:false,
    suExposed:false,
    alliancePrince:false,
    blackened:false
  },
  log: []
});
let State = null;

/* ====== Plotï¼šDay1â€“Day20 ====== */
const Plot = {};
function makeDay(day, title, mainTask, intro, pack){
  Plot[day]={
    title, mainTask, key:"MAIN",
    intro,
    options(state){
      const warn = state.player["ç³»ç»Ÿè­¦å‘Šå€¼"];
      const highWarn = warn>=70;
      const luxBonus = (state.buffs.lux ? 2 : 0);

      // ç»Ÿä¸€4é€‰é¡¹ï¼Œä¿è¯æ¯å¤©éƒ½ä¼šå˜ï¼ˆä½ ä¹‹å‰â€œæ°¸è¿œä¸åŠ¨â€å°±æ˜¯è¿™å—å†™æ­»å¯¼è‡´ï¼‰
      const A = {
        id:`d${day}-main`,
        tag:["ä¸»çº¿","ä½é£é™©"],
        actionKey:"MAIN",
        label: pack.main.label,
        effect: Object.assign({åç¦»åº¦:-1, "ç³»ç»Ÿè­¦å‘Šå€¼":-2, "å¤ªå­å¥½æ„Ÿ":+2, è´µå¥³å£°æœ›:+1 + luxBonus}, pack.main.effect||{}),
        route:{sweet:+2, power:+1, chaos:0},
        story: pack.main.story
      };
      const B = {
        id:`d${day}-chaos`,
        tag:["æ€æ¡Œ","é«˜é£é™©"],
        highlight:true,
        actionKey:"DEFY",
        label: pack.chaos.label,
        effect: Object.assign({æ€æ¡Œå€¼:+6, åç¦»åº¦:+3, "ç³»ç»Ÿè­¦å‘Šå€¼":+6, å¿ƒæ™º:-1, è´µå¥³å£°æœ›:-1}, pack.chaos.effect||{}),
        route:{sweet:0, power:+1, chaos:+3},
        story: pack.chaos.story
      };
      const C = {
        id:`d${day}-str`,
        tag:["è°‹ç•¥","ä¸­é£é™©"],
        actionKey:"STRATEGY",
        label: pack.str.label,
        effect: Object.assign({è°‹ç•¥:+3, åç¦»åº¦:+1, "è‹æ¸…è²æ€€ç–‘":+3, è´µå¥³å£°æœ›:+1}, pack.str.effect||{}),
        route:{sweet:+1, power:+3, chaos:+1},
        story: pack.str.story
      };
      const D = {
        id:`d${day}-rest`,
        tag:["å…»æˆ","ä½é£é™©"],
        actionKey:"REST",
        label: pack.rest.label,
        effect: Object.assign({å¿ƒæ™º:+4, å¥åº·:+4, åç¦»åº¦:+0, "ç³»ç»Ÿè­¦å‘Šå€¼":-1}, pack.rest.effect||{}),
        route:{sweet:+1, power:+0, chaos:+0},
        story: pack.rest.story
      };

      const ops=[A,B,C,D];

      // é«˜è­¦å‘Šé™„åŠ å±æœºæç¤ºï¼ˆä¸é¢å¤–åŠ æŒ‰é’®ï¼Œé¿å…ä½ UIçˆ†ç‚¸ï¼‰
      if(highWarn){
        ops[0].story += `\n\nã€ç³»ç»Ÿæ—ç™½ã€‘è­¦å‘Šå€¼åé«˜ï¼Œä¸»çº¿æ¨è¿›å¯æ˜¾è‘—é™ä½æƒ©ç½šã€‚`;
      }
      return ops;
    }
  };
}

/* Day1â€“Day3ï¼šæ›´ç»†ä¸€ç‚¹ */
makeDay(1,
  "ç¬¬ä¸€æ—¥ Â· å°†å†›åºœ",
  "åˆåå‰å¾€ä¸œå®«é€æ±¤ï¼ˆåŸè‘—å…³é”®èŠ‚ç‚¹ï¼‰",
`ä½ çŒ›åœ°çå¼€çœ¼ã€‚

ç»£å¸ä½å‚ï¼Œæª€é¦™å¹½å¹½ã€‚

ä½ ç©¿è¿›è™æ–‡ï¼Œæˆäº†æœ€ç»ˆæƒ¨æ­»çš„å¥³é…ï¼šæŸ³æ‰¶é£ã€‚

ç³»ç»Ÿå†°å†·å“èµ·ï¼š
ã€ä¸»çº¿ï¼šä»Šæ—¥åˆåå‰å¾€ä¸œå®«ï¼Œä¸ºå¤ªå­é€å‚æ±¤ã€‚ã€‘

åŸè‘—é‡Œï¼Œä½ è¢«è‹æ¸…è²â€œä¸å°å¿ƒâ€æ’ç¿»æ±¤ç›…ï¼Œå¤ªå­å†·çœ¼æ—è§‚ï¼Œä½ æˆäº†ç¬‘æŸ„ã€‚

ä½ æŒ‰ä½èƒ¸å£ï¼šè¿™ä¸€ä¸–ï¼Œä¸å½“æ€¨ç§ã€‚

æ¡Œå­ï¼Ÿä½ æ¥æ€ã€‚`,
{
  main:{
    label:"ç¨³ä½å±€é¢ï¼ˆä¸»çº¿/ä½“é¢æ¨è¿›ï¼‰",
    story:`ä½ ä»å»äº†ä¸œå®«ã€‚

ä½ æŠŠå‚æ±¤é€’ä¸Šå»ï¼Œç¬‘å¾—æ¸©æŸ”å…‹åˆ¶â€”â€”åƒæŠŠåˆ€è—åœ¨è¢–å£ã€‚

å¤ªå­æ…•å®¹ç©æŠ¬çœ¸ï¼šâ€œæ”¾ä¸‹ã€‚â€

é‚£ç›®å…‰å†·å¾—åƒåœ¨ç§°æ–¤ä¸¤ã€‚

ä½ ä¸äº‰è¾©ï¼ŒåªæŠŠæ±¤ç›…æä¸‹ï¼Œè½¬èº«é€€å¼€ã€‚

ä½ èµ¢äº†ç¬¬ä¸€æ­¥ï¼šä¸è®©ç³»ç»ŸæŠ“åˆ°æŠŠæŸ„ã€‚`,
    effect:{}
  },
  chaos:{
    label:"æ€æ¡Œå¼€æ€ï¼ˆé«˜é£é™©é«˜æ”¶ç›Šï¼‰",
    story:`ä½ åœ¨é£åè‹‘è®¾å®´ï¼Œè´µå¥³äº‘é›†ã€‚

ä½ ç«¯å‡ºå‚æ±¤â€”â€”ä¼—äººä»¥ä¸ºä½ è¦è¡¨å¿ ã€‚

ä½ å´å½“ä¼—æŠŠæ±¤å€’è¿›èŠ±æ± ã€‚

ã€è­¦æŠ¥ï¼æ£€æµ‹åˆ°å®¿ä¸»ä¸¥é‡åç¦»ä¸»çº¿ï¼ã€‘

ä½ ç¬‘å¾—æ— è¾œåˆç‹ ï¼š
â€œæ±¤å‡‰äº†ï¼Œé€äººä¸åˆç¤¼æ•°ã€‚å€’äº†ä¸å¯æƒœï¼Œå¯æƒœçš„æ˜¯æˆ‘ä»å‰æµªè´¹åœ¨ä¸œå®«çš„å¿ƒã€‚â€

æ»¡å ‚å“‘ç„¶ã€‚ä½ å¬è§è‡ªå·±å¿ƒè·³â€”â€”ä¸æ˜¯å®³æ€•ï¼Œæ˜¯å…´å¥‹ã€‚`,
    effect:{è´µå¥³å£°æœ›:+2, "å¤ªå­å¥½æ„Ÿ":-2}
  },
  str:{
    label:"è¯æ®æ¨è¿›ï¼ˆè°‹ç•¥çº¿ï¼‰",
    story:`ä½ æ²¡æ€¥ç€æ€æ¡Œã€‚

ä½ æ›´æƒ³çŸ¥é“ï¼šè‹æ¸…è²åˆ°åº•æ˜¯ç™½è²ï¼Œè¿˜æ˜¯å¸¦æ¯’çš„è²ã€‚

ä½ æ´¾æš—å«ç›¯ä¸ç›¸åºœåé™¢ï¼Œé”å®šä¸ä¸œå®«å¾€æ¥çš„äººã€‚

å¤œé‡Œå›æŠ¥ï¼šä¸ç›¸åºœå¬·å¬·ä¸ä¸œå®«å†…ä¾é¢‘ç¹æ¥è§¦ï¼Œä¸”åˆ»æ„é¿å¼€æ­£é—¨ã€‚

ä½ æŒ‡å°–è½»æ•²æ¡Œé¢ï¼šå¥½ã€‚

ä½ é—»åˆ°â€œå‰§æœ¬å¤–â€çš„å‘³é“äº†ã€‚`,
    effect:{}
  },
  rest:{
    label:"é—­é—¨ä¿®æ•´ï¼ˆå›è¡€ç¨³å¿ƒï¼‰",
    story:`ä½ é—­é—¨è°ƒå…»ã€‚

é¦™çƒŸç¼±ç»»ï¼Œå‘¼å¸å›åˆ°ç¨³å®šèŠ‚å¥ã€‚

ç³»ç»Ÿä»å‚¬ä¿ƒï¼Œä½ å´åƒæŠŠé‚£æœºæ¢°éŸ³æŒ‰è¿›æ°´é‡Œã€‚

çˆ½æ€æ¡Œå›ºç„¶ç—›å¿«ï¼Œä½†ä½ è¦æœ‰èƒ½æ‰›æƒ©ç½šçš„èº«ä½“ï¼Œå’Œæ›´ç¡¬çš„å¿ƒã€‚`,
    effect:{}
  }
});

makeDay(2,
  "ç¬¬äºŒæ—¥ Â· åŸä¸­æš—æµ",
  "å®Œæˆä¸€æ¬¡å£ç¢‘/æƒè°‹åŠ¨ä½œï¼ˆç¨³ä½å£°æœ›æˆ–æ¨è¿›è¯æ®ï¼‰",
`ç¬¬äºŒæ—¥æ¸…æ™¨ï¼Œæ°¸å®åŸçš„é£å¸¦ç€å¯’ã€‚

ç³»ç»Ÿæ¢äº†æ–¹å¼â€”â€”å®ƒè®©ä½ â€œçœ‹èµ·æ¥åƒå¥³é…â€ã€‚

ã€æç¤ºï¼šåç¦»åº¦è¶Šé«˜ï¼Œæƒ©ç½šäº‹ä»¶è¶Šé¢‘ç¹ã€‚ã€‘

ä½ æœ›å‘çª—å¤–è½¦é©¬ï¼šè¿™åŸé‡Œæ¯æ¡å··å­éƒ½è—ç€è€³æœµã€‚`,
{
  main:{label:"å¯ºåº™ä½“é¢ï¼ˆç¨³å£°æœ›ï¼‰",story:`ä½ å»åŸä¸­å¯ºåº™æé¦™ç«ï¼Œé¡ºæ‰‹æ•‘ä¸‹è¢«è´µå¥³åˆéš¾çš„å•†è´¾ä¹‹å¥³ã€‚

ä½ ä¸€å¥è¯ä¸å¤šï¼Œå´æŠŠâ€œå°†å†›åºœçš„ä½“é¢â€ç¨³ç¨³ç«‹ä½ã€‚

æµè¨€åƒé›ªï¼Œä½ ä¸æ€¥ç€æ‰«â€”â€”ä½ è®©å®ƒè‡ªå·±èã€‚`,effect:{å®¶æ—å£°æœ›:+2}},
  chaos:{label:"å½“ä¼—æ‹’å·®äº‹ï¼ˆæ€æ¡Œï¼‰",story:`ä½ æŠŠç¤¼éƒ¨é€æ¥çš„â€œå¤ªå­å¦ƒå€™é€‰ç¤¼å†Œâ€åŸå°ä¸åŠ¨é€€å›ã€‚

ä¼—äººå“—ç„¶ï¼šå¥³é…æ€ä¹ˆæ•¢æ‹’ï¼Ÿ

ä½ ç¬‘ï¼šâ€œç¤¼å†Œå¤ªåšï¼Œæˆ‘æ€•æ‰‹é…¸ã€‚â€

æœ‰äººæƒ³ç¬‘åˆä¸æ•¢ã€‚ä½ æŠŠä»–ä»¬çš„è„¸é¢å½“çº¸æ’•ã€‚`,effect:{"å¤ªå­å¥½æ„Ÿ":+1}},
  str:{label:"æ¢è´¦æœ¬å–è¯ï¼ˆè¯æ®æ¨è¿›ï¼‰",story:`ä½ æ´¾äººä»¥â€œé€ç»¸ç¼â€åä¹‰è¿›å…¥ä¸ç›¸åºœåé™¢ã€‚

æš—å«æ¢ä¸‹æ´—è¡£æˆ¿å‡ºå…¥å†Œï¼Œå¸¦å›ä¸€é¡µæ’•ç¢ç¥¨æ®â€”â€”éšçº¦æœ‰â€œä¸œå®«â€å°è®°ã€‚

è¯æ®å¾ˆè–„ï¼Œä½†è–„åˆ€ä¹Ÿèƒ½å‰²å–‰ã€‚

ä½ æŠŠç¢ç‰‡å¤¹è¿›å…µä¹¦ï¼šç­‰å®ƒé•¿æˆä¸€æŠŠå®Œæ•´çš„åˆ€ã€‚`,effect:{è°‹ç•¥:+1}},
  rest:{label:"æŠ„å…µä¹¦ä¿®èº«ï¼ˆå…»æˆï¼‰",story:`ä½ æŠŠè‡ªå·±é”è¿›ä¹¦æˆ¿ï¼Œ
