
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>å·«æ°ä¿®ä»™ä¸–å®¶Â·ç»ˆæè¿›åŒ–ç‰ˆV5</title>
<style>
body{margin:0;background:#050814;color:#eee;font-family:system-ui}
header{background:#121a3a;padding:14px;text-align:center;font-weight:900}
.container{max-width:1200px;margin:auto;padding:12px}
.panel{background:#1a2248;border-radius:16px;padding:14px;margin-bottom:14px}
.option{border:1px solid #444;padding:12px;border-radius:12px;margin:8px 0;cursor:pointer}
.option:hover{background:#26306b}
button{background:#8ab4ff;border:none;border-radius:12px;padding:10px 16px;font-weight:800}
.map{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.cell{background:#0f1538;border-radius:12px;padding:20px;text-align:center}
.hidden{display:none}
</style>
</head>
<body>

<header>ğŸŒŒ å·«æ°ä¿®ä»™ä¸–å®¶ Â· ç»ˆæä¸–ç•Œæ¨¡æ‹Ÿå™¨ V5</header>

<div class="container">

<div class="panel" id="setup">
<h3>é€‰æ‹©æ—é•¿èº«ä»½</h3>
<button onclick="start('ç”·')">ç”·æ—é•¿</button>
<button onclick="start('å¥³')">å¥³æ—é•¿</button>
</div>

<div id="game" class="hidden">

<div class="panel">
ğŸ“† <span id="time"></span> ï½œ ğŸ§¬ <span id="root"></span> ï½œ ğŸ‘¤ <span id="gender"></span>
</div>

<div class="panel" id="story"></div>
<div class="panel" id="options"></div>

<div class="panel">
<h3>ğŸ—º ä¸–ç•Œåœ°å›¾</h3>
<div class="map">
<div class="cell">å®—é—¨å±±è„‰</div>
<div class="cell">å®¶æ—é¢†åœ°</div>
<div class="cell">å¦–å…½å±±è„‰</div>
<div class="cell">é—è¿¹åºŸå¢Ÿ</div>
<div class="cell">å‡¡äººç‹æœ</div>
<div class="cell">æ•£ä¿®é›†å¸‚</div>
</div>
</div>

<div class="panel">
<button onclick="saveGame()">ğŸ’¾ å­˜æ¡£</button>
<button onclick="loadGame()">ğŸ“‚ è¯»æ¡£</button>
</div>

</div>

</div>

<script>
let year=1,month=1,day=1;
let gender=null;
let root=null;

const roots=[
 {n:"å‡¡çµæ ¹",r:45},{n:"åœ°çµæ ¹",r:25},{n:"å¤©çµæ ¹",r:15},{n:"åœ£çµæ ¹",r:10},{n:"æ··æ²Œçµæ ¹",r:5}
];

function rollRoot(){
 let r=Math.random()*100,s=0;
 for(let g of roots){s+=g.r;if(r<=s)return g.n;}
}

function updateTime(){
 document.getElementById("time").innerText=`ç¬¬${year}å¹´${month}æœˆ${day}æ—¥`;
}

function advance(){
 day++;if(day>30){day=1;month++;}
 if(month>12){month=1;year++;}
 updateTime();
}

function showStory(text){
 document.getElementById("story").innerText=text;
 const o=document.getElementById("options");
 o.innerHTML="";
 ["ä¿®ç‚¼","å†…æ”¿","å¤–äº¤","æ¢é™©","åŸ¹å…»","è§‚å¯Ÿ"].forEach(t=>{
   const d=document.createElement("div");
   d.className="option";
   d.innerText=t;
   d.onclick=()=>nextTurn();
   o.appendChild(d);
 });
}

function nextTurn(){
 advance();
 const pool=[
  "çµæ°”æ½®æ±è¿›ä¸€æ­¥è¡°å‡ï¼Œå„æ–¹åŠ¿åŠ›äº‰å¤ºèµ„æºã€‚",
  "é­”é“æš—ä¸­é›†ç»“ï¼Œä¼¼ä¹å‡†å¤‡å‘åŠ¨å¤§æˆ˜ã€‚",
  "å®—é—¨å‘å·«æ°æŠ›å‡ºåˆä½œæ©„æ¦„æã€‚",
  "é—è¿¹ä¸­ä¼ å‡ºå¼‚åŠ¨ï¼Œå¸å¼•æ— æ•°å¼ºè€…ã€‚",
  "å‡¡äººç‹æœè¯·æ±‚åº‡æŠ¤ã€‚"
 ];
 showStory(pool[Math.floor(Math.random()*pool.length)]);
}

function start(g){
 gender=g;
 root=rollRoot();
 document.getElementById("gender").innerText=g+"æ—é•¿";
 document.getElementById("root").innerText="çµæ ¹ï¼š"+root;
 document.getElementById("setup").classList.add("hidden");
 document.getElementById("game").classList.remove("hidden");
 updateTime();
 showStory("æµ‹çµå®Œæˆï¼Œå·«æ°ä¸–å®¶çš„è¿›åŒ–ä¹‹è·¯æ­£å¼å¼€å¯â€¦â€¦");
}

function saveGame(){
 localStorage.setItem("xiuxianSave",JSON.stringify({year,month,day,gender,root}));
 alert("å­˜æ¡£æˆåŠŸï¼");
}

function loadGame(){
 const d=JSON.parse(localStorage.getItem("xiuxianSave"));
 if(!d){alert("æ²¡æœ‰å­˜æ¡£");return;}
 year=d.year;month=d.month;day=d.day;gender=d.gender;root=d.root;
 document.getElementById("gender").innerText=gender+"æ—é•¿";
 document.getElementById("root").innerText="çµæ ¹ï¼š"+root;
 document.getElementById("setup").classList.add("hidden");
 document.getElementById("game").classList.remove("hidden");
 updateTime();
 showStory("å­˜æ¡£è¯»å–å®Œæˆï¼Œä¸–ç•Œç»§ç»­è¿è½¬â€¦â€¦");
}
</script>

</body>
</html>
